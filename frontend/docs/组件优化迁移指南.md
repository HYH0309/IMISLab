# 组件优化迁移指南

## 1. Modal 组件统一

### 当前状况

- `BaseModal.vue` - 使用 6 次
- `AdminModal.vue` - 使用 3 次  
- `ConfirmDialog.vue` - 使用 4 次

### 迁移方案

已创建 `UnifiedModal.vue` 统一所有 Modal 功能。

#### 迁移步骤

**1. BaseModal 迁移**

```vue
<!-- 原来 -->
<BaseModal :show="showModal" @CloseShow="showModal = false">
  <div>内容</div>
</BaseModal>

<!-- 改为 -->
<UnifiedModal v-model="showModal" title="标题">
  <div>内容</div>
</UnifiedModal>
```

**2. AdminModal 迁移**

```vue
<!-- 原来 -->
<AdminModal v-model="showForm" title="编辑" width="md" :loading="isLoading">
  <form>...</form>
</AdminModal>

<!-- 改为 -->
<UnifiedModal v-model="showForm" title="编辑" width="md" type="admin" :loading="isLoading">
  <form>...</form>
</UnifiedModal>
```

**3. ConfirmDialog 迁移**

```vue
<!-- 原来 -->
<ConfirmDialog 
  v-model:show="showConfirm" 
  title="删除确认"
  content="确定要删除这个项目吗？"
  @confirm="handleDelete"
/>

<!-- 改为 -->
<UnifiedModal 
  v-model="showConfirm" 
  title="删除确认"
  content="确定要删除这个项目吗？"
  type="confirm"
  danger
  @confirm="handleDelete"
/>
```

## 2. ControlPanel 组件统一

### 当前状况

- `DPControlPanel.vue` - 算法选择 + 速度控制 + 操作按钮
- `SearchControlPanel.vue` - 算法选择 + 速度控制 + 迷宫生成
- `SortControlPanel.vue` - 算法选择 + 速度控制 + 数组操作

### 迁移方案

已创建 `VisualizerControl.vue` 通用控制面板。

#### 迁移示例

**DP 控制面板迁移**

```vue
<script setup lang="ts">
import VisualizerControl from '@/components/common/VisualizerControl.vue'
import { useDPStore } from '@/stores/dpStore'

const store = useDPStore()

const handleStart = () => store.startDPing()
const handleReset = () => store.resetMatrix()
const handleNextStep = () => store.nextStep()
</script>

<template>
  <VisualizerControl
    :algorithms="store.state.algorithms"
    :selected-algorithm="store.state.selectedAlgorithm"
    :speed="store.state.speed"
    :is-running="store.state.isDPing"
    :is-manual-mode="store.state.isManualMode"
    @update:selected-algorithm="store.state.selectedAlgorithm = $event"
    @update:speed="store.state.speed = $event"
    @update:is-manual-mode="store.state.isManualMode = $event"
    @start="handleStart"
    @reset="handleReset"
    @next-step="handleNextStep"
  />
</template>
```

**Search 控制面板迁移（带自定义操作）**

```vue
<VisualizerControl
  :algorithms="algorithms"
  :selected-algorithm="store.state.selectedAlgorithm"
  :speed="store.state.speed"
  :is-running="store.state.isSearching"
  :custom-actions="[
    { label: '生成迷宫', action: 'generateMaze', color: 'purple' },
    { label: '随机墙壁', action: 'generateWalls', color: 'cyan' }
  ]"
  @custom-action="handleCustomAction"
/>
```

## 3. Status 组件统一

### 迁移方案

已创建 `VisualizerStatus.vue` 通用状态显示组件。

#### 迁移示例

**DP 状态迁移**

```vue
<script setup lang="ts">
import VisualizerStatus from '@/components/common/VisualizerStatus.vue'
import { useDPStore } from '@/stores/dpStore'
import { ChartBarIcon, CurrencyDollarIcon, CubeIcon } from '@heroicons/vue/20/solid'

const store = useDPStore()

const metrics = computed(() => [
  {
    id: 'step',
    label: '步骤',
    value: store.state.stats.currentStep,
    icon: ChartBarIcon,
    color: 'primary'
  },
  {
    id: 'value',
    label: '最大价值',
    value: store.state.stats.maxValue,
    icon: CurrencyDollarIcon,
    color: 'success'
  },
  {
    id: 'capacity',
    label: '剩余容量',
    value: store.state.stats.remainingCapacity,
    icon: CubeIcon,
    color: 'warning'
  }
])
</script>

<template>
  <VisualizerStatus
    title="动态规划状态"
    :description="store.state.description"
    :metrics="metrics"
  />
</template>
```

## 4. 迁移优先级

### 高优先级（立即可迁移）

1. ✅ 删除未使用组件（已完成）
2. 🔄 Modal 组件统一（可逐步替换）
3. 🔄 添加新的分析脚本（已完成）

### 中优先级（逐步迁移）

1. ControlPanel 组件统一
2. Status 组件统一
3. 优化 TypeScript 配置

### 低优先级（未来优化）

1. 依赖清理和更新
2. 构建优化
3. 代码拆分优化

## 5. 迁移后的收益

### 代码减少

- Modal 相关: 3个组件 → 1个组件
- ControlPanel: 3个组件 → 1个通用组件 + 简化的具体实现
- Status: 3个组件 → 1个通用组件 + 简化的具体实现

### 维护性提升

- 统一的 API 设计
- 减少重复代码
- 更好的类型安全
- 更容易测试

### 性能提升

- 减少包体积
- 更好的 Tree Shaking
- 组件复用提升

## 6. 下一步操作

1. 选择一个模块开始迁移（建议从 Modal 开始）
2. 在开发环境测试迁移后的功能
3. 逐步替换其他使用点
4. 删除旧的组件文件
5. 运行 `npm run analyze:components` 验证清理效果

迁移过程中遇到问题可以随时回滚到原有实现。
